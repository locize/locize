!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).locize={})}(this,(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function n(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?t(Object(o),!0).forEach((function(t){i(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){var t={top:0,left:0,right:0,bottom:0},n=e&&e.ownerDocument,i=n&&n.documentElement;if(!i)return t;"undefined"!==o(e.getBoundingClientRect)&&(t=e.getBoundingClientRect());var r=function(e){return null!=(t=e)&&t===t.window?e:9===e.nodeType&&e.defaultView;var t}(n),a=t.top+r.pageYOffset-i.clientTop,s=t.left+r.pageXOffset-i.clientLeft;return{top:a,left:s,right:s+(t.right-t.left),bottom:a+(t.bottom-t.top)}}function a(e,t){return e&&e.getAttribute&&e.getAttribute(t)}function s(e){var t=a(e,"data-i18n");return t||(e.nodeType===window.Node.TEXT_NODE&&e.parentElement?s(e.parentElement):void 0)}function d(e){var t;return function e(n){var o=a(n,"i18next-options");if(o||(o=a(n,"data-i18next-options")),o||(o=a(n,"i18n-options")),o||(o=a(n,"data-i18n-options")),o){var i={};try{i=JSON.parse(o)}catch(e){}i.ns&&(t=i.ns)}t||(t=a(n,"i18next-ns")),t||(t=a(n,"data-i18next-ns")),t||(t=a(n,"i18n-ns")),t||(t=a(n,"data-i18n-ns")),!t&&n.parentElement&&e(n.parentElement)}(e),t}function l(e){return function(t){var n=function(e){if(e.srcElement&&1===e.srcElement.nodeType&&("BUTTON"===e.srcElement.nodeName||"INPUT"===e.srcElement.nodeName))return e.srcElement.getAttribute&&""===e.srcElement.getAttribute("ignorelocizeeditor")?null:e.srcElement;var t;if(e.originalEvent&&e.originalEvent.explicitOriginalTarget)t=e.originalEvent.explicitOriginalTarget;else{var n=e.srcElement;if(n.getAttribute&&""===n.getAttribute("ignorelocizeeditor"))return null;for(var o,i=e.pageX,a=e.pageY,s=0,d=0;d<n.childNodes.length;d++){var l=n.childNodes[d],c=r(l);1===l.nodeType&&c.bottom<a&&(s=d+1),!o&&c.top+(l.clientHeight||0)>a&&(o=d)}s+1>n.childNodes.length&&(s=n.childNodes.length-1),o||(o=n.childNodes.length);for(var p=s;p<o;p++){var f=n.childNodes[p];if(r(f).left>i)break;f&&8!==f.nodeType&&(t=f)}}return t}(t);if(!n)return{};t.preventDefault(),t.stopPropagation();var o=function(e){var t=e.textContent||e.text&&e.text.innerText||e.placeholder;if("string"==typeof t)return t.replace(/\n +/g,"").trim()}(n),i=s(n),a=n.getBoundingClientRect?n:n.parentElement,l=a.getBoundingClientRect(),c=l.top,p=l.left,f=l.width,u=l.height,g=window.getComputedStyle(a,null),m=parseFloat(g.getPropertyValue("padding-top")),b=parseFloat(g.getPropertyValue("padding-bottom")),y=parseFloat(g.getPropertyValue("padding-right")),v=parseFloat(g.getPropertyValue("padding-left")),h=g.getPropertyValue("box-sizing");e({tagName:a.tagName,text:o,key:i,ns:d(n),box:{top:c,left:p,width:"border-box"===h?f:f-y-v,height:"border-box"===h?u:u-m-b},style:g.cssText})}}function c(e){var t=window.document.createElement("div");t.setAttribute("style",'font-family: "Helvetica", "Arial", sans-serif; bottom: 20px; right: 20px; padding: 10px; background-color: #fff; border: solid 1px #1976d2; box-shadow: 0px 1px 2px 0px rgba(0,0,0,0.5); border-radius: 3px; z-index: 2147483647; position: fixed;'),t.setAttribute("ignorelocizeeditor",""),t.setAttribute("translated","");var o=window.document.createElement("h4");o.id="locize-title",o.innerHTML="Translate InContext:",o.setAttribute("style",'font-family: "Helvetica", "Arial", sans-serif; font-size: 14px; margin: 0 0 5px 0; color: #1976d2; font-weight: 300;'),o.setAttribute("ignorelocizeeditor",""),t.appendChild(o);var i=window.document.createElement("button");i.innerHTML="Open in locize",i.setAttribute("style","".concat('font-family: "Helvetica", "Arial", sans-serif; font-size: 14px; color: #fff; border: none; font-weight: 300; height: 30px; line-height: 30px; padding: 0 15px; text-align: center; min-width: 90px; text-decoration: none; text-transform: uppercase; text-overflow: ellipsis; white-space: nowrap; outline: none; cursor: pointer; border-radius: 15px;',"  background-color: #1976d2;")),i.onclick=function(){var t=e.getI18next(),o=t&&t.options&&t.options.backend,i=n(n({},o),e),r=i.projectId,a=i.version,s=e.editorUrl||o&&o.loadPath&&0===o.loadPath.indexOf("https://api-dev.locize.app")&&"https://dev.locize.app"||"https://www.locize.app";window.location="".concat(s,"/cat/").concat(r,"/v/").concat(a,"/incontext?sourceurl=").concat(encodeURI(window.location.href))},i.setAttribute("ignorelocizeeditor",""),t.appendChild(i),window.document.body.appendChild(t)}var p,f,u,g,m,b,y=!0;try{y=self!==top}catch(e){}function v(e){m=e}var h,w=[];function x(e,t,n,o){var i={message:"added",lng:e,ns:t,key:n,value:o};p?p.postMessage(i,f):w.push(i)}var O={type:"3rdParty",init:function(e){h=e,v((function(t){t.updated.forEach((function(t){var n=t.lng,o=t.ns,i=t.key,r=t.data;e.addResource(n,o,i,r.value,{silent:!0}),e.emit("editorSaved")}))})),y&&(e.options.missingKeyHandler=function(e,t,n,o,i,r){i||x(e,t,n,o)})}};function E(){return h}"undefined"!=typeof window&&window.addEventListener("message",(function(e){if("isLocizeEnabled"===e.data.message)p||(p=e.source,f=e.origin,u=l((function(e){p.postMessage({message:"clickedElement",payload:e},f)}))),p.postMessage({message:"locizeIsEnabled",enabled:!0},e.origin),w.forEach((function(t){p.postMessage(t,e.origin)})),w=[];else if("turnOn"===e.data.message){if(b)return p.postMessage({message:"forcedOff"},f);g||window.document.body.addEventListener("click",u,!0),g=!0,p.postMessage({message:"turnedOn"},f)}else if("turnOff"===e.data.message){if(b)return p.postMessage({message:"forcedOff"},f);g&&window.document.body.removeEventListener("click",u,!0),g=!1,p.postMessage({message:"turnedOff"},f)}else if("committed"===e.data.message){var t=e.data.payload;window.locizeSavedHandler&&window.locizeSavedHandler(t),m&&m(t)}})),e.addLocizeSavedHandler=v,e.locizePlugin=O,e.onAddedKey=x,e.showLocizeLink=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y||c(n(n({},e),{},{getI18next:E}))},e.turnOff=function(){return b=!0,g&&window.document.body.removeEventListener("click",u,!0),g=!1,p&&p.postMessage({message:"turnedOff"},f),p&&p.postMessage({message:"forcedOff"},f),b},e.turnOn=function(){return b=!1,g||window.document.body.addEventListener("click",u,!0),g=!0,p&&p.postMessage({message:"turnedOn"},f),b},Object.defineProperty(e,"__esModule",{value:!0})}));
