!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).locize={})}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function r(e){var n={top:0,left:0,right:0,bottom:0},o=e&&e.ownerDocument,i=o&&o.documentElement;if(!i)return n;"undefined"!==t(e.getBoundingClientRect)&&(n=e.getBoundingClientRect());var r=function(e){return null!=(t=e)&&t===t.window?e:9===e.nodeType&&e.defaultView;var t}(o),a=n.top+r.pageYOffset-i.clientTop,s=n.left+r.pageXOffset-i.clientLeft;return{top:a,left:s,right:s+(n.right-n.left),bottom:a+(n.bottom-n.top)}}function a(e,t){return e&&e.getAttribute&&e.getAttribute(t)}function s(e){var t=a(e,"data-i18n");return t||(e.nodeType===window.Node.TEXT_NODE&&e.parentElement?s(e.parentElement):void 0)}function d(e){var t;return function e(n){var o=a(n,"i18next-options");if(o||(o=a(n,"data-i18next-options")),o||(o=a(n,"i18n-options")),o||(o=a(n,"data-i18n-options")),o){var i={};try{i=JSON.parse(o)}catch(e){}i.ns&&(t=i.ns)}t||(t=a(n,"i18next-ns")),t||(t=a(n,"data-i18next-ns")),t||(t=a(n,"i18n-ns")),t||(t=a(n,"data-i18n-ns")),!t&&n.parentElement&&e(n.parentElement)}(e),t}function c(e,t){return function(n){var o=function(e){if(e.srcElement&&1===e.srcElement.nodeType&&("BUTTON"===e.srcElement.nodeName||"INPUT"===e.srcElement.nodeName))return e.srcElement.getAttribute&&""===e.srcElement.getAttribute("ignorelocizeeditor")?null:e.srcElement;var t;if(e.originalEvent&&e.originalEvent.explicitOriginalTarget)t=e.originalEvent.explicitOriginalTarget;else{var n=e.srcElement;if(n.getAttribute&&""===n.getAttribute("ignorelocizeeditor"))return null;for(var o,i=e.pageX,a=e.pageY,s=0,d=0;d<n.childNodes.length;d++){var c=n.childNodes[d],l=r(c);1===c.nodeType&&l.bottom<a&&(s=d+1),!o&&l.top+(c.clientHeight||0)>a&&(o=d)}s+1>n.childNodes.length&&(s=n.childNodes.length-1),o||(o=n.childNodes.length);for(var f=s;f<o;f++){var u=n.childNodes[f];if(r(u).left>i)break;u&&8!==u.nodeType&&(t=u)}}return t}(n);if(!o)return{};n.preventDefault(),n.stopPropagation();var i=function(e){var t=e.textContent||e.text&&e.text.innerText||e.placeholder;if("string"==typeof t)return t.replace(/\n +/g,"").trim()}(o),a=s(o),c=o.getBoundingClientRect?o:o.parentElement,l=c.getBoundingClientRect(),f=l.top,u=l.left,p=l.width,g=l.height,m=window.getComputedStyle(c,null),b=parseFloat(m.getPropertyValue("padding-top")),y=parseFloat(m.getPropertyValue("padding-bottom")),v=parseFloat(m.getPropertyValue("padding-right")),h=parseFloat(m.getPropertyValue("padding-left")),w=m.getPropertyValue("box-sizing");e({tagName:c.tagName,text:i,key:a,ns:d(o)||function(){var e=t.getI18next();if(e&&e.options&&e.options.isLocizify)return e.options.defaultNS}(),box:{top:f,left:u,width:"border-box"===w?p:p-v-h,height:"border-box"===w?g:g-b-y},style:m.cssText})}}function l(e){var t=window.document.createElement("div");t.setAttribute("style",'font-family: "Helvetica", "Arial", sans-serif; bottom: 20px; right: 20px; padding: 10px; background-color: #fff; border: solid 1px #1976d2; box-shadow: 0px 1px 2px 0px rgba(0,0,0,0.5); border-radius: 3px; z-index: 2147483647; position: fixed;'),t.setAttribute("ignorelocizeeditor",""),t.setAttribute("translated","");var n=window.document.createElement("h4");n.id="locize-title",n.innerHTML="Translate InContext:",n.setAttribute("style",'font-family: "Helvetica", "Arial", sans-serif; font-size: 14px; margin: 0 0 5px 0; color: #1976d2; font-weight: 300;'),n.setAttribute("ignorelocizeeditor",""),t.appendChild(n);var o=window.document.createElement("button");o.innerHTML="Open in locize",o.setAttribute("style","".concat('font-family: "Helvetica", "Arial", sans-serif; font-size: 14px; color: #fff; border: none; font-weight: 300; height: 30px; line-height: 30px; padding: 0 15px; text-align: center; min-width: 90px; text-decoration: none; text-transform: uppercase; text-overflow: ellipsis; white-space: nowrap; outline: none; cursor: pointer; border-radius: 15px;',"  background-color: #1976d2;")),o.onclick=function(){var t=e.getI18next(),n=t&&t.options&&t.options.backend,o=i(i({},n),e),r=o.projectId,a=o.version,s=e.editorUrl||n&&n.loadPath&&0===n.loadPath.indexOf("https://api-dev.locize.app")&&"https://dev.locize.app"||"https://www.locize.app";window.location="".concat(s,"/cat/").concat(r,"/v/").concat(a,"/incontext?sourceurl=").concat(encodeURI(window.location.href))},o.setAttribute("ignorelocizeeditor",""),t.appendChild(o),window.document.body.appendChild(t)}var f,u,p,g,m,b,y=!0;try{y=self!==top}catch(e){}function v(e){m=e}var h,w=[];function x(e,t,n,o){var i={message:"added",lng:e,ns:t,key:n,value:o};f?f.postMessage(i,u):w.push(i)}var O={type:"3rdParty",init:function(e){h=e,v((function(t){t.updated.forEach((function(t){var n=t.lng,o=t.ns,i=t.key,r=t.data;e.addResource(n,o,i,r.value,{silent:!0}),e.emit("editorSaved")}))})),y&&(e.options.missingKeyHandler=function(e,t,n,o,i,r){i||x(e,t,n,o)}),h.on("languageChanged",(function(e){!function(e){f&&f.postMessage({message:"setLng",lng:e},u)}(e)}))}};function E(){return h}"undefined"!=typeof window&&window.addEventListener("message",(function(e){if("isLocizeEnabled"===e.data.message)f||(f=e.source,u=e.origin,p=c((function(e){f.postMessage({message:"clickedElement",payload:e},u)}),{getI18next:E})),f.postMessage({message:"locizeIsEnabled",enabled:!0},e.origin),w.forEach((function(t){f.postMessage(t,e.origin)})),w=[];else if("turnOn"===e.data.message){if(b)return f.postMessage({message:"forcedOff"},u);g||window.document.body.addEventListener("click",p,!0),g=!0,f.postMessage({message:"turnedOn"},u)}else if("turnOff"===e.data.message){if(b)return f.postMessage({message:"forcedOff"},u);g&&window.document.body.removeEventListener("click",p,!0),g=!1,f.postMessage({message:"turnedOff"},u)}else if("committed"===e.data.message){var t=e.data.payload;window.locizeSavedHandler&&window.locizeSavedHandler(t),m&&m(t)}}));var z=document.location.href;window.addEventListener("load",(function(){var e=document.querySelector("body");new MutationObserver((function(e){e.forEach((function(e){z!=document.location.href&&(z=document.location.href,f&&f.postMessage({message:"hrefChanged",href:z},u))}))})).observe(e,{childList:!0,subtree:!0})})),e.addLocizeSavedHandler=v,e.locizePlugin=O,e.onAddedKey=x,e.showLocizeLink=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y||l(i(i({},e),{},{getI18next:E}))},e.turnOff=function(){return b=!0,g&&window.document.body.removeEventListener("click",p,!0),g=!1,f&&f.postMessage({message:"turnedOff"},u),f&&f.postMessage({message:"forcedOff"},u),b},e.turnOn=function(){return b=!1,g||window.document.body.addEventListener("click",p,!0),g=!0,f&&f.postMessage({message:"turnedOn"},u),b},Object.defineProperty(e,"__esModule",{value:!0})}));
