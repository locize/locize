!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).locize={})}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e){var n={top:0,left:0,right:0,bottom:0},o=e&&e.ownerDocument,r=o&&o.documentElement;if(!r)return n;"undefined"!==t(e.getBoundingClientRect)&&(n=e.getBoundingClientRect());var i=function(e){return null!=(t=e)&&t===t.window?e:9===e.nodeType&&e.defaultView;var t}(o),a=n.top+i.pageYOffset-r.clientTop,s=n.left+i.pageXOffset-r.clientLeft;return{top:a,left:s,right:s+(n.right-n.left),bottom:a+(n.bottom-n.top)}}function a(e,t){return e&&e.getAttribute&&e.getAttribute(t)}function s(e){var t=a(e,"data-i18n");return t||(e.nodeType===window.Node.TEXT_NODE&&e.parentElement?s(e.parentElement):void 0)}function d(e){var t;return function e(n){var o=a(n,"i18next-options");if(o||(o=a(n,"data-i18next-options")),o||(o=a(n,"i18n-options")),o||(o=a(n,"data-i18n-options")),o){var r={};try{r=JSON.parse(o)}catch(e){}r.ns&&(t=r.ns)}t||(t=a(n,"i18next-ns")),t||(t=a(n,"data-i18next-ns")),t||(t=a(n,"i18n-ns")),t||(t=a(n,"data-i18n-ns")),!t&&n.parentElement&&e(n.parentElement)}(e),t}function l(e){return function(t){var n=function(e){if(e.srcElement&&1===e.srcElement.nodeType&&("BUTTON"===e.srcElement.nodeName||"INPUT"===e.srcElement.nodeName))return e.srcElement.getAttribute&&""===e.srcElement.getAttribute("ignorelocizeeditor")?null:e.srcElement;var t;if(e.originalEvent&&e.originalEvent.explicitOriginalTarget)t=e.originalEvent.explicitOriginalTarget;else{var n=e.srcElement;if(n.getAttribute&&""===n.getAttribute("ignorelocizeeditor"))return null;for(var o,r=e.pageX,a=e.pageY,s=0,d=0;d<n.childNodes.length;d++){var l=n.childNodes[d],c=i(l);1===l.nodeType&&c.bottom<a&&(s=d+1),!o&&c.top+(l.clientHeight||0)>a&&(o=d)}s+1>n.childNodes.length&&(s=n.childNodes.length-1),o||(o=n.childNodes.length);for(var f=s;f<o;f++){var u=n.childNodes[f];if(i(u).left>r)break;u&&8!==u.nodeType&&(t=u)}}return t}(t);if(!n)return{};t.preventDefault(),t.stopPropagation();var o=function(e){var t=e.textContent||e.text&&e.text.innerText||e.placeholder;if("string"==typeof t)return t.replace(/\n +/g,"").trim()}(n),r=s(n),a=n.getBoundingClientRect?n:n.parentElement,l=a.getBoundingClientRect(),c=l.top,f=l.left,u=l.width,p=l.height,g=window.getComputedStyle(a,null),m=parseFloat(g.getPropertyValue("padding-top")),b=parseFloat(g.getPropertyValue("padding-bottom")),y=parseFloat(g.getPropertyValue("padding-right")),v=parseFloat(g.getPropertyValue("padding-left")),h=g.getPropertyValue("box-sizing");e({tagName:a.tagName,text:o,key:r,ns:d(n),box:{top:c,left:f,width:"border-box"===h?u:u-y-v,height:"border-box"===h?p:p-m-b},style:g.cssText})}}function c(e){var t=document.createElement("div");t.setAttribute("style",'font-family: "Helvetica", "Arial", sans-serif; bottom: 20px; right: 20px; padding: 10px; background-color: #fff; border: solid 1px #1976d2; box-shadow: 0px 1px 2px 0px rgba(0,0,0,0.5); border-radius: 3px; z-index: 2147483647; position: fixed;'),t.setAttribute("ignorelocizeeditor",""),t.setAttribute("translated","");var n=document.createElement("h4");n.id="locize-title",n.innerHTML="Translate InContext:",n.setAttribute("style",'font-family: "Helvetica", "Arial", sans-serif; font-size: 14px; margin: 0 0 5px 0; color: #1976d2; font-weight: 300;'),n.setAttribute("ignorelocizeeditor",""),t.appendChild(n);var o=document.createElement("button");o.innerHTML="Open in locize",o.setAttribute("style","".concat('font-family: "Helvetica", "Arial", sans-serif; font-size: 14px; color: #fff; border: none; font-weight: 300; height: 30px; line-height: 30px; padding: 0 15px; text-align: center; min-width: 90px; text-decoration: none; text-transform: uppercase; text-overflow: ellipsis; white-space: nowrap; outline: none; cursor: pointer; border-radius: 15px;',"  background-color: #1976d2;")),o.onclick=function(){var t=e.getI18next(),n=r(r({},t&&t.options&&t.options.backend),e),o=n.projectId,i=n.version;window.location="https://www.locize.app/cat/".concat(o,"/v/").concat(i,"/incontext?sourceurl=").concat(encodeURI(window.location.href))},o.setAttribute("ignorelocizeeditor",""),t.appendChild(o),document.body.appendChild(t)}var f,u,p,g,m,b,y=!0;try{y=self!==top}catch(e){}function v(e){m=e}var h,w=[];function x(e,t,n,o){var r={message:"added",lng:e,ns:t,key:n,value:o};f?f.postMessage(r,u):w.push(r)}var O={type:"3rdParty",init:function(e){h=e,v((function(t){t.updated.forEach((function(t){var n=t.lng,o=t.ns,r=t.key,i=t.data;e.addResource(n,o,r,i.value,{silent:!0}),e.emit("editorSaved")}))})),y&&(e.options.missingKeyHandler=function(e,t,n,o,r,i){r||x(e,t,n,o)})}};function E(){return h}"undefined"!=typeof window&&window.addEventListener("message",(function(e){if("isLocizeEnabled"===e.data.message)f||(f=e.source,u=e.origin,p=l((function(e){f.postMessage({message:"clickedElement",payload:e},u)}))),f.postMessage({message:"locizeIsEnabled",enabled:!0},e.origin),w.forEach((function(t){f.postMessage(t,e.origin)})),w=[];else if("turnOn"===e.data.message){if(b)return f.postMessage({message:"forcedOff"},u);g||window.document.body.addEventListener("click",p,!0),g=!0,f.postMessage({message:"turnedOn"},u)}else if("turnOff"===e.data.message){if(b)return f.postMessage({message:"forcedOff"},u);g&&window.document.body.removeEventListener("click",p,!0),g=!1,f.postMessage({message:"turnedOff"},u)}else if("committed"===e.data.message){var t=e.data.payload;window.locizeSavedHandler&&window.locizeSavedHandler(t),m&&m(t)}}));e.addLocizeSavedHandler=v,e.locizePlugin=O,e.onAddedKey=x,e.showLocizeLink=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y||c(r(r({},e),{},{getI18next:E}))},e.turnOff=function(){return b=!0,g&&window.document.body.removeEventListener("click",p,!0),g=!1,f&&f.postMessage({message:"turnedOff"},u),f&&f.postMessage({message:"forcedOff"},u),b},e.turnOn=function(){return b=!1,g||window.document.body.addEventListener("click",p,!0),g=!0,f&&f.postMessage({message:"turnedOn"},u),b},Object.defineProperty(e,"__esModule",{value:!0})}));
